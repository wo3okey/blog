{"componentChunkName":"component---src-templates-post-jsx","path":"/AWS-kinesis/","result":{"data":{"site":{"siteMetadata":{"title":"wookey-devlog"}},"markdownRemark":{"id":"e93b2124-bb9f-5095-bd8e-9f673bcbb688","excerpt":"kinesis 란 는 대규모의 실시간 데이터 스트리밍 처리를 지원하는 pub/sub 모델을 구현한 AWS 관리형 서비스이다. data strems kinesis data streams의 아키텍처 구조이다. 용어를 정리하면서 간단히 알아보자.  구성 설명 producer - data stream에 데이터를 보내는 주체의 서버 또는 애플리케이션 consume…","html":"<h2>kinesis 란</h2>\n<p><code class=\"language-text\">kinesis</code>는 대규모의 실시간 데이터 스트리밍 처리를 지원하는 pub/sub 모델을 구현한 AWS 관리형 서비스이다.</p>\n<h3>data strems</h3>\n<p>kinesis data streams의 아키텍처 구조이다. 용어를 정리하면서 간단히 알아보자.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/4a2489fcf938a214433689c5bd7a6326/b4ad3/aws-kinesis-02.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 74.11764705882352%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAADtklEQVR42p1Ub2wTZRg/pTCEgARkC0ayBIkxBDAbwTiigAhqdCb4zfiFP5HELyMRv6hRq5DKUCZzZiYji7qE6TIjGTI6REYHgaVXb1tnWNtd/1y77bp2XW/3p3dv767dz+t1bH7gk0/yJJfnz+/9/Z7nvZeiLGPHfDVTw30HeWAVXJVVaHvh4/53NhwIN1S+h+5tK+A/tBrdzhWZu+fWSPT3dbLX9ZI87NpY6gX0WgD7iShupcoBOCJ3umjl2icYncNRl8u10zz39MsTXvfx+OCVpul4tB6DHzxWqtX8bS+SkYtFzP4NhfM0wte4JxBLSJ/1xZGSyO8PAJdH0nO+tKxgbMbEic4QYzcTctXKgRDt/hywTp0cOa14Pu0RY1fNSDQEcZq9W7znuhSJjutN/RwEzbi8CMgmM/RkVoQvmmWP/BRsVZprdppMR1CI0Iwgk/PT0/7VUvTem8rAF2dyCa9uCmGowa6GUr/OhdP5lrMgM6lFhg4uq9BpzUQwo75lhRxwO9fmmZZnIbP2nFRp5mRekp5Rfd/szg21YG6Cgcz/0yff/uq8xoeI4r0JQ5HKDD0WIK/kadVCjhAcwC7q8fnW2s9vHal8hf1w8/ulmrwqXdQ0Y58x9MMuKeVHIsFBTDDt4kDju8ZsOIdQB4q5zKJkxyjH08MshxRwENXUSuXCc/unfNePx2l3c3KSe0MWkvvkJLtRG7pQpwV7ilACIOPdZcm6mjGKUygYhSXJo7FJmglFkTbxKrVgGtHtpei6HuCZtlV2bKxrrxy4VIixfsipMK0NnO4hQsIwTALDWFqK436c94YmeEzkzNfsmXUeft6gfxyVuOE7gqKfxWBT+drEevZqmUCRSEloCc9H0ZvNVXlFFMBPwSgU/it5kh4KsMgCNuCcx7kOvce2YOb2JhtIyZ7SFWW7wjTtyI11pnJjv2iF4M/HSjmTiDPQeBSNpXu4LJwR3aGUQDgDdZbo9cXWmq8HjlYeGj+1yZ6TZi2FEGIfxrobn/L9embzvLuhIgisKWQtepFeFDXhtwfjoq4PDq7vuXHjyW4LXOrYvSH37Y5afsRzYmrkVgs/EXk7m47vEWK91QsEHil56ds7j7UFIZWE2A+DZC9TDzMw9eUFaOU/RTeMAMu6K9BGLbfzTuejJbevnAcOVZVOirNcY16VDy+COK2Cktund1PL9PbXawy6nZG54f6san7Jur+rgHtrBfV/bN5qxB/1T+Av5xZEr1TZrP60XhtP9cqHKrLGtOA2638ByFe8mmtWPhEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='aws kinesis 02' title='' src='/static/4a2489fcf938a214433689c5bd7a6326/ca1dc/aws-kinesis-02.png' srcset='/static/4a2489fcf938a214433689c5bd7a6326/e7570/aws-kinesis-02.png 170w,\n/static/4a2489fcf938a214433689c5bd7a6326/f46e7/aws-kinesis-02.png 340w,\n/static/4a2489fcf938a214433689c5bd7a6326/ca1dc/aws-kinesis-02.png 680w,\n/static/4a2489fcf938a214433689c5bd7a6326/02d09/aws-kinesis-02.png 1020w,\n/static/4a2489fcf938a214433689c5bd7a6326/b4ad3/aws-kinesis-02.png 1080w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<table>\n<thead>\n<tr>\n<th>구성</th>\n<th>설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>producer</td>\n<td>- data stream에 데이터를 보내는 주체의 서버 또는 애플리케이션</td>\n</tr>\n<tr>\n<td>consumer</td>\n<td>- data stream에서 데이터를 읽어들이고 처리하는 주체의 서버 또는 애플리케이션</td>\n</tr>\n<tr>\n<td>stream</td>\n<td>- 데이터 스트리밍을 처리하는 기본 단위이며, data recode로 구성</td>\n</tr>\n<tr>\n<td>shard</td>\n<td>- stream 내에서 data recode의 처리를 병렬화 하는 방법이며, stream을 구성하는 단위 <br> - stream은 하나 이상의 shard로 구성</td>\n</tr>\n<tr>\n<td>data recode</td>\n<td>- stream을 통해 전송되는 데이터 가장 작은 데이터 단위 <br> - sequence number, partition key, Blob로 구성됨 <br> - 일반적으로 json으로 작성하며, 최대 1MB까지의 크기를 가지고 shard를 통해 분산 처리</td>\n</tr>\n<tr>\n<td>partition key</td>\n<td>- stream 내에서 shard별로 데이터를 그룹화 하는데 사용 <br> - 동일한 partition key를 가진 data recode는 동일한 shard로 라우팅 <br> - MD5 hash 함수를 통해 data recode를 shard 매핑</td>\n</tr>\n<tr>\n<td>sequence number</td>\n<td>- 각 data recode의 유일한 식별자이며, 모든 데이터 레코드에는 시스템에서 자동으로 생성된 고유 번호 할당 <br> - sequence number는 각 shard에서 recode 순서를 유지하는데 사용</td>\n</tr>\n</tbody>\n</table>\n<h3>KPL/KCL</h3>\n<p>AWS에서는 KPL, KCL을 지원하여 kinesis data stream을 쉽고 빠르게 구축 할 수 있도록 지원한다.</p>\n<ul>\n<li><code class=\"language-text\">KPL(Kinesis Producer Library)</code>은 kinesis data stream에 데이터를 추가할 수 있는 애플레케이션을 쉽게 구축 할 수 있도록 지원하는 라이브러리</li>\n<li><code class=\"language-text\">KCL(Kinesis Client Library)</code>은 kinesis data stream의 데이터를 읽고 처리하는 애플리케이션을 쉽게 구축할 수 있도록 지원하는 라이브러리</li>\n</ul>\n<h2>용량 모드</h2>\n<p>kinesis data stream을 생성할 때에는 두가지 비용의 용량모드를 선택할 수 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/e164e1b4da5e9bfa51e68d252aefcc3f/583a7/aws-kinesis-03.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 101.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADLUlEQVR42o1U227bRhDl1/dL2rf0tUVhpygCA0VbBE4cRJYsUcvl8m6J1+XyzunMkLQDo2i7wMGsRO6ZmTNnaXlBAPefPsPX3SN8evgCj/sDPGCM4hgqrSEvCijK8l+B74yAS0h5a9EfnueD5wfgI7nyPEaeF9A0DRhj/hN1XTPh4enp1qIqoihegFUpV3ECrWsYxxGGvl8wDNCvceiHl//pv67rmHC32/9g1ZghzXK4pimUVQXbmucZpg3TtO6ndb9EemdenjPh6XR6ZxlsiwgvVyLUrBuBKqzqGvQ/gJ73WOU3yZnweDy+szaCBcvLZVmtgldcNe3fRiKm7gh61fAsxI1Fh4UjaUIcjyebD5A2bdtC23WMbo0ve3q2AofHhLZtv7coU1nkUOQ5NJitRQlI7AkH8i1oQJtm4/p7Aw7qtWXS0E5yOPkJxIUGMwPoCTEuKIcZin6CAQ+yTWqzEMPr2oYihLi1DJbslh183Nnw+UnAXobw6ASwd0PYCR8kJku7GXq0iyNd2B+O6NmQfRug1RRGLwiZMAjDO6umKWMFdnQFkWQQFAa8TC9IK0h0D9dusUmDyfU6uGp1BA0J95uGt+zDZ7TMBX2Yoo5XtFBPuiABoUF7mI7Ny1UOL3jRjwa4amj/yIQn6cPjWcFhhfBjOHsR2F4MXpTA5XKFBEF+peRR8owXIcPptott9GIb13V/tYxpIKsMxFkFuhugHWeoscUaZajwRvXjxMJThRpbpPh2bcZ2HPkzV3i5XCDLMuBhzTS/meM8v86SNIuxWvpo0Blq9y0hXr2FMAgj/jCkSBpjO8/Y3jMmSbGtjZPaPdlnkMrjdulW1dgdYbsp+/3+e/bh/1n4ieKkcZxwRzkOMENQxMRMqJS6oQpH1G5CjLrtJ91uccPAKE03ppWZMt1MhekmgxZAnSmOCBbWkeo3i3TysOKwatmDYdlw9HNCDQq9SJ5M8HmEnpQGK8GmFMUWwEcqr1luyu7p+JPluOqDdNX92XV/l17w8eTIP6UK7h3lf0E8SOXvzq7a2UK+R/3uXOV9tYX4y/X9+7Nw/hCO+wuevxGuOny4u/vub1Z88l3LC8AVAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='aws kinesis 03' title='' src='/static/e164e1b4da5e9bfa51e68d252aefcc3f/ca1dc/aws-kinesis-03.png' srcset='/static/e164e1b4da5e9bfa51e68d252aefcc3f/e7570/aws-kinesis-03.png 170w,\n/static/e164e1b4da5e9bfa51e68d252aefcc3f/f46e7/aws-kinesis-03.png 340w,\n/static/e164e1b4da5e9bfa51e68d252aefcc3f/ca1dc/aws-kinesis-03.png 680w,\n/static/e164e1b4da5e9bfa51e68d252aefcc3f/583a7/aws-kinesis-03.png 1013w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<ul>\n<li>\n<p>온디맨드(on-demand)</p>\n<ul>\n<li>stream 처리량이 불규칙하거나 예측할 수 없는 경우에 사용을 권장</li>\n<li>데이터 처리량에 따라 shard의 수를 조정해주며, 처리한 데이터량에 따라 비용이 결정</li>\n<li>shard의 수를 직접 늘릴 수 없음</li>\n</ul>\n</li>\n<li>\n<p>프로비저닝(provisioned)</p>\n<ul>\n<li>stream 처리량을 어느정도 예측할 수 있는 경우에 사용을 권장</li>\n<li>shard 수를 직접 설정하여 stream을 생성하여, 미리 할당한 shard의 갯수에 따라 비용이 결정</li>\n<li>shard의 수를 직접 늘릴 수 있음</li>\n</ul>\n</li>\n</ul>\n<p>요약하자면, 온디맨드 모드는 비교적 예측할 수 없는 데이터 stream 처리량에 적합하며, 프로비저닝 모드는 처리량을 예측할 수 있는 경우에 적합하다. 어떤 모드를 선택하든, 처리량에 따라 샤드당 시간당 요금이 발생하므로 처리할 데이터 양과 예상되는 비용을 고려하여 적절한 모드를 선택해야 한다.</p>\n<h3>모드 변경</h3>\n<p>kinesis data stream은 필요에 따라 라이브 서비스 중에도 즉각적으로 용량 모드를 변경할 수 있다. 아래의 예시는 AWS 블로그에서 예시 상황을 설명한 글이다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/75f5bc91dec780726fe0e6adeb715676/42a19/aws-kinesis-04.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA+UlEQVR42oVRf2+EIAzl+3+1/b9lubt5EdEYo4BnQLQtoz23bMu2a/J4tKGvP1CImB+BiDLxHeBXAADmYvM81ypTfmi4bRlTyvQH+Akf3nut6IegdPMlSPt+T6J/K4vgstwahUifIh9CWBgJBXsIZWy4+4jfGDguwENw0YpXlFEG5zjGFGhNkeIWKIaZQrhR3NfiR0qQkHk9fGZGERbBEIJRUg24Kkk14g54zBKHsjvumhcvfHwQHP69Q8kXwRijUUbrt8aYizHmeRiGs/O+ts7pwtfJuco6ex3HsXLOvVprXwpX4zS11vpT3dVn3ZRsY05t17V93z+9A4i7IhbfxO3DAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='aws kinesis 04' title='' src='/static/75f5bc91dec780726fe0e6adeb715676/ca1dc/aws-kinesis-04.png' srcset='/static/75f5bc91dec780726fe0e6adeb715676/e7570/aws-kinesis-04.png 170w,\n/static/75f5bc91dec780726fe0e6adeb715676/f46e7/aws-kinesis-04.png 340w,\n/static/75f5bc91dec780726fe0e6adeb715676/ca1dc/aws-kinesis-04.png 680w,\n/static/75f5bc91dec780726fe0e6adeb715676/02d09/aws-kinesis-04.png 1020w,\n/static/75f5bc91dec780726fe0e6adeb715676/42a19/aws-kinesis-04.png 1024w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n먼저 5개의 shard로 프로비저닝 모드로 생성된 stream이 있다고 한다. 처음 3분 동안 4MB/s의 로드를 전송하고 있고, 정상적으로 처리 하고 있다. 이후 타임스탬프 21:19에 로드를 12MB/s로 늘리며, stream이 더이상 로드를 처리할 수 없게되며 빨간색 선의 제한된 요청에 대한 수치가 높아지고 있는 모습이 보인다.\n이에 따라 타임스탬프 21:23에서 프로비저닝 용량모드에서 온디맨드 모드로 변경한다. stream에 영향을 주지 않고 즉시 적용할 수 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/42a19/aws-kinesis-05.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 32.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA2UlEQVR42m2Q3YoDIQyFff/H690WFvZ6pVqnMEk0Pz0621KWET8iyjkxJxFR2BgHZuERYe5v/KNinwLdlMVvzj9pGmrvYRPicNVYy/+BpaanGCzne875mph5dV8ebjFoDxFgPUTlqH/nrv0Us8OwlHJNxOyiHcibzrsr0wfsiMRP/v1ijVVr/UpdJAby66PH0CPHBUaf+DzjHab4Pa3q0DgiQrN1B481Ymvbd3qUYq1Wu7dm6KDbY4OGjIkd+SJWth2VRQzxOO+7y5yK2Eq7Wak3u0M3o4P+8gRSa9YmKuIo4AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='aws kinesis 05' title='' src='/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/ca1dc/aws-kinesis-05.png' srcset='/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/e7570/aws-kinesis-05.png 170w,\n/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/f46e7/aws-kinesis-05.png 340w,\n/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/ca1dc/aws-kinesis-05.png 680w,\n/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/02d09/aws-kinesis-05.png 1020w,\n/static/1e6ab5d0d3dbe5a06bf41b68c49a432e/42a19/aws-kinesis-05.png 1024w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n타임스탬프 21:24 시점부터 stream이 확장되면서 제한이 떨어지기 시작한다. 타임스탬프 21:26 시점에 stream 용량은 최초5개의 shard의 2배인 10개의 shard로 확장되고, 각 shard에서 로드가 0.5MB/s 미만의 수준으로 처리가능 할 때까지 stream은 계속 확장된다. </p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/546333e67fff45e3fb1e44d7b616d143/512a1/aws-kinesis-06.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6UlEQVR42p2QwW7DIAyGef8323FaG7TetoU2SqRCupAYsPEMDVIv3aGGTzbG+jFWRMSUM+cX4LLFJ0wSMXvvZ5VDYBJesUSJAYFDClVwWRanStBEKVMFM3LA8C+70L3T2ivzum2zqgKEvHrHAJ5DLIVQx9AeeEYzaoLralXESGVJmjgEIgjEGxBHydUB7+CDx4dzIcuXxADgqjAlRkQZbCHdayQueXpCu4vymySjEmqHMUanTN8fe2OOxpiPcRy1c05baw9unt+tcwehE/TVWr2fS/x5u/2evobv7sf03flyOQ3DoKdpevsD0EQh3ecP9/UAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='aws kinesis 06' title='' src='/static/546333e67fff45e3fb1e44d7b616d143/ca1dc/aws-kinesis-06.png' srcset='/static/546333e67fff45e3fb1e44d7b616d143/e7570/aws-kinesis-06.png 170w,\n/static/546333e67fff45e3fb1e44d7b616d143/f46e7/aws-kinesis-06.png 340w,\n/static/546333e67fff45e3fb1e44d7b616d143/ca1dc/aws-kinesis-06.png 680w,\n/static/546333e67fff45e3fb1e44d7b616d143/02d09/aws-kinesis-06.png 1020w,\n/static/546333e67fff45e3fb1e44d7b616d143/9d567/aws-kinesis-06.png 1360w,\n/static/546333e67fff45e3fb1e44d7b616d143/512a1/aws-kinesis-06.png 4026w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n이후 빨간색의 제한된 처리에 대한 수치가 사라지고, 안정적으로 서비스되고 있는 모습을 볼 수 있다. 이처럼 stream이 갑자기 대량의 로드를 받게되면 온디맨드 모드에서는 이를 처리할 수 있는 shard 용량을 확보할 수 있다.</p>\n<p>온디맨드 모드와 프로비저닝 모드 간을 하루에 두 번 전환할 수 있다. 프로비저닝된 모드에서 온디맨드 모드로 전환할 때 데이터 스트림의 shard 수는 동일하게 유지되며 그 반대의 경우도 마찬가지이다. 반대의 경우에는 kinesis data streams는 데이터 트래픽을 모니터링하고 트래픽 증가 또는 감소에 따라 온디맨드 data stream의 shard 수를 늘리거나 줄인다.</p>\n<h2>shard</h2>\n<p><code class=\"language-text\">shard</code>는 간단하게 stream을 구성하는 단위라고 위에서 설명했다. 좀 더 자세히 알아보자.</p>\n<h3>처리량</h3>\n<p>shard의 갯수는 곧 stream에서 단위시간에 처리할 수 있는 data recode의 갯수를 뜻한다. kinesis data stream에서 제공하는 shard 관련 처리량 스펙은 아래와 같다.</p>\n<ul>\n<li>단일 stream 기준 최대 설정 가능 shard 수는 200개(50개 이상부터는 AWS에 문의해야함)</li>\n<li>단일 shard 기준 읽기 처리량은 초당 5 transaction, 최대 2MB까지 지원</li>\n<li>단일 shard 기준 쓰기 처리량은 초당 1000개의 data recode 또는 초당 1MB 까지 지원</li>\n</ul>\n<h3>shard 갯수 설정</h3>\n<p>용량모드 중 <code class=\"language-text\">프로비저닝</code> 모드에서는 최초 stream 생성시 shard의 수를 지정해줘야 한다. 그렇다면 적절한 shard의 수는 어떻게 알 수 있을까?</p>\n<ul>\n<li>average<em>data</em>size<em>in</em>KB: 스트림에 쓰여지는 평균 데이터 레코드 수(KB), 1KB에 가깝게 반올림한 데이터 레코드 수</li>\n<li>records<em>per</em>second: 스트림에서 초당 쓰고 읽는 데이터 레코드 수</li>\n<li>incoming<em>write</em>bandwidth<em>in</em>KB: average<em>data</em>size<em>in</em>KB에 records<em>per</em>second를 곱한 값</li>\n<li>outgoing<em>read</em>bandwidth<em>in</em>KB: incoming<em>write</em>bandwidth<em>in</em>KB에 number<em>of</em>consumers를 곱한 값</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">number_of_shards = max(incoming_write_bandwidth_in_KiB/1024, outgoing_read_bandwidth_in_KiB/2048)</code></pre></div>\n<p>AWS에서 가이드 하는 개수 설정 방법은 조금 복잡해 보일 수 있다. 로그 데이터 파이프라인 서비스나 대량의 스트리밍 서비스 등의 작업이 아닌 이상 단일 shard 정도로도 꽤나 준수한 처리량을 제공받을 수 있다.</p>\n<h2>결론</h2>\n<p>AWS kinesis는 운영 설정이나 관리 포인트를 대폭 감소시키고 각종 라이브러리까지 지원하여 쉽고 빠르게 대규모 스트리밍 서비스를 개발할 수 있도록 지원하고 있다.\n특히 AWS 관리형 서비스 답게 별도의 복잡한 설정이나 시스템 구축에 대한 허들 없이도 가능한 것이 매우 장점으로 보인다. 다만 굳이 <a href=\"https://wo3okey.github.io/kafka/2023/02/22/kafka.html\">kafka</a>와 비교하자면 kinesis는 shard에 대해 속도나 용량등의 제한적 처리량을 강제화하고 있는것은 사실이자 단점일 수 있다.</p>\n<blockquote>\n<p>AWS를 사용하는 인프라 시스템에서 쉽고 빠르게 대규모 스트리밍, 이벤트 메세지 시스템 등을 구축하기에 kinesis 서비스는 꽤 좋은 선택지가 될 수 있다.</p>\n</blockquote>\n<h2></h2>\n<hr>\n<h3></h3>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/ko_kr/streams/latest/dev/introduction.html\">https://docs.aws.amazon.com/ko_kr/streams/latest/dev/introduction.html</a></li>\n<li><a href=\"https://docs.aws.amazon.com/ko_kr/streams/latest/dev/how-do-i-size-a-stream.html\">https://docs.aws.amazon.com/ko_kr/streams/latest/dev/how-do-i-size-a-stream.html</a></li>\n<li><a href=\"https://www.softkraft.co/aws-kinesis-vs-kafka-comparison/\">https://www.softkraft.co/aws-kinesis-vs-kafka-comparison/</a></li>\n<li><a href=\"https://aws.amazon.com/ko/blogs/korea/amazon-kinesis-data-streams-on-demand-stream-data-at-scale-without-managing-capacity/\">https://aws.amazon.com/ko/blogs/korea/amazon-kinesis-data-streams-on-demand-stream-data-at-scale-without-managing-capacity/</a></li>\n</ul>","frontmatter":{"title":"AWS kinesis basic","date":"May 29, 2023","update":"May 29, 2023","tags":["aws","kinesis"],"series":"aws"},"fields":{"slug":"/AWS-kinesis/","readingTime":{"minutes":9.795}}},"seriesList":{"edges":[{"node":{"id":"e93b2124-bb9f-5095-bd8e-9f673bcbb688","fields":{"slug":"/AWS-kinesis/"},"frontmatter":{"title":"AWS kinesis basic"}}},{"node":{"id":"b9b2e471-f011-5f5c-a317-c5383a4220f1","fields":{"slug":"/aws-ecs/"},"frontmatter":{"title":"AWS ECS with git action 간단 체크포인트"}}}]},"previous":{"fields":{"slug":"/elasticsearch-change-shard/"},"frontmatter":{"title":"elasticsearch shard 값은 왜 변경이 불가할까?"}},"next":{"fields":{"slug":"/http-protocol/"},"frontmatter":{"title":"HTTP 프로토콜 진화 과정"}}},"pageContext":{"id":"e93b2124-bb9f-5095-bd8e-9f673bcbb688","series":"aws","previousPostId":"59308eb0-8332-5b36-b1c3-77a4ccbea27b","nextPostId":"fd12c43f-bc04-581f-8e37-6ae38bdf515b"}},"staticQueryHashes":[],"slicesMap":{}}